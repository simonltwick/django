{% extends 'bike/base.html' %}

{% block content %}
<h1>Rides</h1>

<h3>Choose a subset of rides:</h3>
<form method='POST'>
<table class="table">
{{ form }}
{% csrf_token %}
</table>
<input type="submit" class="btn btn-primary" value="Apply Filter">
<input type="submit" class="btn btn-secondary" value="Download as CSV"
    formaction="{% url 'bike:rides' %}?action=download_as_csv">
</form>

<h3>Rides</h3>
{% for ride in rides %}

{% if forloop.first %}
  <table class="table">
  <tr><th>date</th><th>bike</th><th>ride</th><th>distance</th></tr>
{% endif %}

<tr>
  <td>{{ ride.date }}</td><td>{{ ride.bike }}</td>
  <td>
    {% if ride.is_adjustment %}
	  <a href="{% url 'bike:odometer_adjustment_ride' ride_id=ride.id %}">
    {% else %}
	  <a href="{% url 'bike:ride' ride.id %}">
    {% endif %}
    {{ ride.description|truncatechars:40 }}</a></td>
  <td>{{ ride.distance|floatformat }} {{ ride.get_distance_units_display }}</td>
</tr>

{% if forloop.last %}
  </table>
{% endif %}

{% empty %}
<p>No rides found :-(</p>
{% endfor %}

{% endblock %}
